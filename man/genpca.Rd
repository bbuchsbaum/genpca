% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gpca.R
\name{genpca}
\alias{genpca}
\title{Generalized Principal Components Analysis}
\usage{
genpca(
  X,
  A = NULL,
  M = NULL,
  ncomp = min(dim(X)),
  preproc = multivarious::center(),
  deflation = FALSE,
  threshold = 1e-06,
  use_cpp = TRUE,
  maxeig = 800,
  warn_approx = TRUE
)
}
\arguments{
\item{X}{the data matrix}

\item{A}{the column constraints. Can be a \code{vector}, symmetric \code{matrix}, or symmetric sparse matrix with \code{ncol(X)} rows and columns.}

\item{M}{the row constraints. Can be a \code{vector}, symmetric \code{matrix}, or symmetric sparse matrix with \code{nrow(X)} rows and columns.}

\item{ncomp}{the number of components to return}

\item{preproc}{a pre-processing function (e.g. \code{center()} or \code{standardize()} from \code{multivarious} package, see Details)}

\item{deflation}{use the iterative deflation method}

\item{threshold}{convergence threshold for deflation method}

\item{use_cpp}{use the C++ implementation}
\item{maxeig}{upper bound on the dimension used for eigen decompositions.
If the dimension of a constraint matrix is at most this value a full eigen
decomposition is used. Otherwise only the leading \code{maxeig} eigenvalues are
computed, yielding an approximate result.}
\item{warn_approx}{logical; emit a warning when an approximate eigen
decomposition is used.}
}
\value{
an instance of type \code{genpca}, extending \code{bi_projector}
}
\description{
Compute a PCA in a inner-product space defined by row and column constraint matrices.
}
\details{
Pre-processing such as scaling and centering is carried out using special functions from the \code{multivarious} package.
Basic options are \code{multivarious::center()}, \code{multivarious::standardize()}, and for no pre-processing at all, \code{multivarious::pass()}.
When \code{method = "eigen"}, the \code{maxeig} parameter controls how eigen
decompositions of the constraint matrices are performed. If the dimension of a
constraint matrix does not exceed \code{maxeig} a full eigen decomposition is
used. Otherwise only the leading \code{maxeig} eigenvalues and vectors are
computed via \code{RSpectra::eigs_sym}, producing an approximate result.
Set \code{warn_approx = FALSE} to suppress the warning about this
approximation.
}
\examples{
X <- matrix(rnorm(100*100), 100,100)
A <- cov(X)
M <- cov(t(X))
gp1 <- genpca(X, A=A, M=M, ncomp=100)

Xrecon <- reconstruct(gp1)

gp2 <- truncate(gp1,2)

}
\references{
Abdi, H. (2007). Singular value decomposition (SVD) and generalized singular value decomposition. \emph{Encyclopedia of measurement and statistics}, 907-912.

Allen, G. I., Grosenick, L., & Taylor, J. (2014). A generalized least-square matrix decomposition. \emph{Journal of the American Statistical Association}, 109(505), 145-159.
}
