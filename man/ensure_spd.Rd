% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/constraints_utils.R
\name{ensure_spd}
\alias{ensure_spd}
\title{Ensure SPD (sparse-friendly)}
\usage{
ensure_spd(M, tol = 1e-06, nearpd_maxn = 2000L)
}
\arguments{
\item{M}{numeric matrix or Matrix::Matrix}

\item{tol}{jitter tolerance (default 1e-8)}

\item{nearpd_maxn}{only use nearPD when n <= nearpd_maxn and matrix is dense}
}
\value{
a Matrix object (sparse stays sparse when possible)
}
\description{
Force a symmetric matrix to be symmetric positive definite (SPD).
Uses a Gershgorin-based diagonal shift; falls back to nearPD for small dense matrices.
}
\keyword{internal}
